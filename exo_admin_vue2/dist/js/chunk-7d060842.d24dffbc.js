(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d060842"],{"05d5":function(t,e,a){},"0a0b":function(t,e,a){},"1a69":function(t,e,a){},"4ac5":function(t,e,a){"use strict";a("05d5")},"4b65":function(t,e,a){},"4dc8":function(t,e,a){"use strict";var o=function(){var t=this,e=t._self._c;return e("dialog-aside",t._b({ref:"modal",attrs:{"hide-action-toolbar":!1,"hide-back-action":!0},on:{hide:t.onModalHide,hidden:t.onModalHidden},scopedSlots:t._u([{key:"actions",fn:function(){return[e("action-button",{attrs:{icon:t.$icons.confirm},on:{action:function(e){return e.preventDefault(),t.ok.apply(null,arguments)}}})]},proxy:!0}])},"dialog-aside",t.$dialogsProps,!1),[void 0!==t.localValue?[e("react-query-builder",{staticClass:"mt-3",attrs:{forms:t.forms},model:{value:t.localValue,callback:function(e){t.localValue=e},expression:"localValue"}})]:t._e()],2)},n=[],r=a("0475"),s=a("001c"),i={name:"SetupQBRulesAside",props:{value:{required:!0},forms:{type:Array,required:!0}},mixins:[s["a"]],components:{ReactQueryBuilder:r["a"]}},l=i,c=(a("daf9"),a("2877")),u=Object(c["a"])(l,o,n,!1,null,"20b384e4",null);e["a"]=u.exports},"58fa":function(t,e,a){},"6d23":function(t,e,a){"use strict";a("1a69")},"8c0e":function(t,e,a){"use strict";a("dda8")},"983f":function(t,e,a){},b850:function(t,e,a){"use strict";a("0a0b")},bf20:function(t,e,a){"use strict";a("983f")},c2c1:function(t,e,a){"use strict";a("58fa")},d9ea:function(t,e,a){"use strict";a("4b65")},daf9:function(t,e,a){"use strict";a("f611")},dda8:function(t,e,a){},f04d:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t._self._c;return e("app-screen",[e("react-layout-controller",{attrs:{layout:t.layout}})],1)},n=[],r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"grid-controller"},[e("waiter",{ref:"waiter",attrs:{show:t.$store.state.rl.busy}},[e("action-toolbar",[e("action-group",[e("action-back"),e("select-layout-template")],1),e("action-group",{attrs:{right:""}},[e("select-scope")],1)],1),e("layout-setup")],1)],1)},s=[],i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"select-layout-template"},[e("label",{staticClass:"select-layout-template__label"},[t._v("Layout template")]),e("x-select",{attrs:{disabled:t.disabled,placeholder:"Select layout template",clearable:!1,options:t.options,value:t.value},on:{select:t.onSetTemplate}})],1)},l=[],c=(a("96cf"),a("3b8d")),u=(a("ac6a"),a("cadf"),a("456d"),{name:"SelectLayoutTemplate",data:function(){return{}},computed:{templates:function(){return this.$store.state.rl.templates},options:function(){return Object.keys(this.templates).map((function(t){return{id:t,label:t}}))},value:function(){return this.$store.getters["rl/getTemplateName"]},disabled:function(){return!this.$store.getters["rl/getScope"]}},methods:{onSetTemplate:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=1,this.$store.dispatch("rl/setTemplateName",{template_name:e.id});case 1:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}}),d=u,p=(a("b850"),a("2877")),m=Object(p["a"])(d,i,l,!1,null,"cad3dad6",null),f=m.exports,h=function(){var t=this,e=t._self._c;return e("div",{staticClass:"select-scope"},[e("label",{staticClass:"select-scope__label mr-1"},[t._v("Layout scope")]),e("x-select",{attrs:{placeholder:"select scope",options:t.options,clearable:!1,value:t.value},on:{select:t.onScopeSelect},scopedSlots:t._u([{key:"option-label",fn:function(a){var o=a.node,n=(a.shouldShowCount,a.count,a.labelClassName);a.countClassName;return[e("label",{class:n},[e("span",[t._v(t._s(o.label))]),t._v(" \n                "),e("span",{staticClass:"text-muted"},[t._v(t._s(o.raw.info))])])]}},{key:"value-label",fn:function(a){var o=a.node;return[e("span",[t._v(t._s(o.label))]),t._v(" \n            "),e("span",{staticClass:"text-muted"},[t._v(t._s(o.raw.info))])]}}])})],1)},b=[],_={name:"SelectScope",computed:{options:function(){return this.$store.getters["rl/getScopes"]},value:function(){return this.$store.getters["rl/getScope"]}},methods:{onScopeSelect:function(t){this.$store.dispatch("rl/setScope",{scope:t.id})}}},g=_,v=(a("bf20"),Object(p["a"])(g,h,b,!1,null,null,null)),k=v.exports,y=(a("7f7f"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"layout-setup mt-3"},[e("div",{staticClass:"grid-template"},[t.template_name?t._l(t.template,(function(a){return e("template-slot",{key:"_"+t.template_name+"_"+a.name,attrs:{"slot-data":a}})})):[e("div",{staticClass:"layout-empty-template"},[e("p",[t._v("Please select "+t._s(t.whatNeedSelect)+"\n                ")])])]],2),e("blocks-list")],1)}),w=[],x=function(){var t=this,e=t._self._c;return e("div",{class:t.classes,style:{gridColumn:t.slotData.column,gridRow:t.slotData.row}},[e("div",{staticClass:"template-slot-header"},[e("h4",{staticClass:"slot-legend"},[t._v("\n            "+t._s(t.slotData.name)+"\n        ")]),t.slotData.disabled?t._e():e("action-group",[e("action-dropdown",{attrs:{icon:t.$icons.add,title:"Add items",size:"sm"},scopedSlots:t._u([{key:"dropdown",fn:function(){return[e("b-dropdown-item",{on:{click:t.addNewItem}},[t._v("Add new block")]),e("b-dropdown-item",{on:{click:t.addItems}},[t._v("Select existing block")])]},proxy:!0}],null,!1,381008747)})],1)],1),t.slotData.disabled?e("div",{staticStyle:{"min-height":"33px"}}):e("b-list-group",[e("Container",{attrs:{"data-empty-title":"Press '+' or drag a block from the right to this slot","group-name":"1","get-child-payload":t.getChildPayload,"drag-class":"item-drag-class","drop-placeholder":t.placeholderOptions,"remove-on-drop-out":!1},on:{drop:t.onDrop}},t._l(t.items,(function(a,o){return e("Draggable",{key:a[t.keyName]+"_"+o},[e("block-row",{attrs:{block:a},on:{remove:function(e){return t.removeItem(o)},edit:function(e){return t.editItem(a["react_id"])}}})],1)})),1)],1)],1)},S=[],$=a("75fc"),C=a("3f7d"),O=function(){var t=this,e=t._self._c;return e("b-list-group-item",{staticClass:"list-base-item block-row",class:{"block-row--out-scope":t.react.out_of_scope}},[e("div",{staticClass:"drag-handle"},[e("icon",{attrs:{icon:t.$icons.dragable}})],1),e("div",[t._v(t._s(t.react.react_title))]),e("div",{staticClass:"block-row__secondary ml-auto"},[e("span",{staticClass:"text-muted"},[t._v(t._s(t.react.react_id))])]),e("div",{staticClass:"block-row__actions"},[e("action-group",[e("action-button",{attrs:{title:"Remove block",icon:t.$icons.group_remove},on:{action:function(e){return t.$emit("remove")}}}),e("action-button",{attrs:{title:"Edit block",icon:t.$icons.edit},on:{action:function(e){return t.$emit("edit")}}})],1)],1)])},j=[],R={name:"BlockRow",props:{block:{type:Object}},computed:{react:function(){return this.$store.state.rl.blocks[this.block.react_id]||{react_title:"Out of scope (".concat(this.block.react_id,")"),out_of_scope:!0}}}},A=R,D=(a("8c0e"),Object(p["a"])(A,O,j,!1,null,"15fda41f",null)),B=D.exports,N=function(){var t=this,e=t._self._c;return e("dialog-aside",t._b({ref:"modal",attrs:{"hide-action-toolbar":!0},on:{hide:t.onModalHide,hidden:t.onModalHidden}},"dialog-aside",t.$dialogsProps,!1),[e("react-form",{ref:"form",attrs:{react_id:t.react_id,form_id:t.form_id,react_edition_id:t.react_edition_id},on:{save:t.onSave},scopedSlots:t._u([{key:"actionBefore",fn:function(){return[e("action-button",{attrs:{icon:t.$icons.back},on:{action:function(e){return e.preventDefault(),t.hide.apply(null,arguments)}}})]},proxy:!0}])})],1)},T=[],I=a("bbbb"),L=a("001c"),F={name:"EditReactAside",components:{ReactForm:I["a"]},mixins:[L["a"]],props:{react_id:{},form_id:{},react_edition_id:{}},computed:{},methods:{onSave:function(t){this.localValue=t}}},P=F,V=Object(p["a"])(P,N,T,!1,null,"465d3bc8",null),H=V.exports,M=function(){var t=this,e=t._self._c;return e("dialog-aside",t._b({ref:"modal",attrs:{"hide-action-toolbar":!0},on:{hide:t.onModalHide,hidden:t.onModalHidden}},"dialog-aside",t.$dialogsProps,!1),[e("select-react-table",{attrs:{"confirm-title":t.confirmTitle,"allow-add-new":t.allowAddNew,"back-route":t.cancel,forms:t.forms,"data-api":t.dataApi},on:{confirm:t.onConfirmSelect}})],1)},q=[],Q=function(){var t=this,e=t._self._c;return e("div",{staticClass:"select-react-table"},[e("react-data-table",{attrs:{forms:t.forms,"row-click-edit":!1,"show-filters":!1,"data-api":t.dataApi,"show-search":!0,"allow-add-new":t.allowAddNew,"use-pagination":!1},scopedSlots:t._u([{key:"beforeActions",fn:function(a){return[e("action-back",{attrs:{"back-route":t.backRoute}}),e("action-button",{attrs:{disabled:0===a.rows.length,title:t.confirmTitle,icon:t.$icons.confirm},on:{action:function(e){return t.onConfirm(a.rows)}}}),e("action-group-separator")]}}])})],1)},G=[],E=a("d0f3"),J={name:"SelectReactTable",components:{ReactDataTable:E["a"]},props:{forms:{type:[Array,Boolean]},confirmTitle:{type:String,default:"Confirm"},dataApi:{type:Function},backRoute:{type:[String,Boolean,Object,Function],default:!0},allowAddNew:{type:Boolean,default:!0}},methods:{onConfirm:function(t){this.$emit("confirm",t)}}},z=J,K=Object(p["a"])(z,Q,G,!1,null,"05c2a57d",null),U=K.exports,W={name:"SelectReactsAside",mixins:[L["a"]],components:{SelectReactTable:U},props:{forms:{required:!0},allowAddNew:{default:!1},confirmTitle:{},dataApi:{type:Function}},methods:{onConfirmSelect:function(t){this.localValue=t,this.ok()}}},X=W,Y=Object(p["a"])(X,M,q,!1,null,"44322a7e",null),Z=Y.exports,tt=a("115e"),et=a("5d44"),at=function(t,e){var a=e.removedIndex,o=e.addedIndex,n=e.payload;if(null===a&&null===o)return t;var r=Object($["a"])(t),s=n;return null!==a&&(s=r.splice(a,1)[0]),null!==o&&r.splice(o,0,s),r},ot={name:"TemplateSlot",components:{Container:C["Container"],Draggable:C["Draggable"],BlockRow:B},props:{slotData:{}},data:function(){return{keyName:"react_id",placeholderOptions:{className:"slot-drop-placeholder",animationDuration:"150",showOnTop:!1}}},computed:{classes:function(){return{"template-slot":!0,"template-slot--disabled":this.slotData.disabled}},items:function(){return this.slotData.name&&this.$store.getters["rl/getCurrentLayout"][this.slotData.name]||[]}},methods:{getChildPayload:function(t){return this.items[t]},getGhostParent:function(){return document.body},onDrop:function(t){if(null!==t.removedIndex||null!==t.addedIndex){var e=Object($["a"])(this.items);e=at(e,t),this.$store.dispatch("rl/updateSlotItemsAndSave",{slot_name:this.slotData.name,items:e})}},removeItem:function(t){var e=Object($["a"])(this.items);e.splice(t,1),this.$store.dispatch("rl/updateSlotItemsAndSave",{slot_name:this.slotData.name,items:e})},addNewItem:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e,a,o,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$store.getters["forms/getFormByName"]("pageblock"),t.next=1,this.$dialogs.show(H,{react_id:null,form_id:e.form_id});case 1:if(a=t.sent,o=a.value,!o){t.next=3;break}return n=[].concat(Object($["a"])(this.items),[{react_id:o}]),t.next=2,this.$store.dispatch("rl/updateSlotItemsAndSave",{slot_name:this.slotData.name,items:n});case 2:return t.next=3,this.$store.dispatch("rl/loadBlocks");case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),addItems:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e,a,o,n,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$store.getters["forms/getFormByName"]("pageblock"),a=Object(tt["a"])(e)?[]:[{form_id:e.form_id}],t.next=1,this.$dialogs.show(Z,{forms:a,dataApi:function(){return et["a"].searchBlocks.apply(et["a"],arguments)},confirmTitle:"Add selected items to slot"});case 1:if(o=t.sent,n=o.trigger,r=o.value,"ok"===n){t.next=2;break}return t.abrupt("return");case 2:return s=[].concat(Object($["a"])(this.items),Object($["a"])(r.map((function(t){return{react_id:t.react_id}})))),t.next=3,this.$store.dispatch("rl/updateSlotItemsAndSave",{slot_name:this.slotData.name,items:s});case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),editItem:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=1,this.$dialogs.show(H,{react_id:e});case 1:return t.next=2,this.$store.dispatch("rl/loadBlocks");case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}},nt=ot,rt=(a("d9ea"),Object(p["a"])(nt,x,S,!1,null,null,null)),st=rt.exports,it=function(){var t=this,e=t._self._c;return e("div",{staticClass:"blocks-list"},[e("div",{staticClass:"blocks-list-header"},[e("h3",{staticClass:"blocks-list-legend"},[t._v("\n            Available blocks\n        ")]),e("search-block-input",{model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),e("action-group",{staticClass:"blocks-list-header__actions"},[e("new-block-action"),e("setup-filter-action")],1)],1),e("screen-scroll-container",{attrs:{"height-option":3}},[e("b-list-group",[e("Container",{attrs:{"group-name":"1",behaviour:"copy","get-child-payload":t.getChildPayload,"get-ghost-parent":t.getGhostParent,"remove-on-drop-out":!1}},t._l(t.blocks,(function(a){return e("Draggable",{key:a["react_id"]},[e("b-list-group-item",{staticClass:"blocks-list-item draggable-item",attrs:{button:""}},[e("icon",{attrs:{icon:t.$icons.pageblock}}),t._v("\n                        "+t._s(a.react_title)+"\n                    ")],1)],1)})),1)],1)],1)],1)},lt=[],ct=(a("55dd"),a("6762"),a("2fdb"),a("8615"),a("386d"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"search-block-input"},[e("icon",{attrs:{icon:t.$icons.search}}),e("b-form-input",t._g(t._b({},"b-form-input",t.$attrs,!1),t.$listeners))],1)}),ut=[],dt={name:"search-block-input"},pt=dt,mt=(a("4ac5"),Object(p["a"])(pt,ct,ut,!1,null,"a799ea84",null)),ft=mt.exports,ht=function(){var t=this,e=t._self._c;return e("action-button",{attrs:{icon:t.$icons.new,title:"Add new block"},on:{action:t.addNew}})},bt=[],_t={name:"NewBlockAction",computed:{form_id:function(){var t=this.$store.getters["forms/getFormByName"]("pageblock");return t?t["form_id"]:null}},methods:{addNew:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=1,this.$dialogs.show(H,{form_id:this.form_id});case 1:if(e=t.sent,!e.value){t.next=2;break}return t.next=2,this.$store.dispatch("rl/loadBlocks");case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},gt=_t,vt=Object(p["a"])(gt,ht,bt,!1,null,null,null),kt=vt.exports,yt=function(){var t=this,e=t._self._c;return e("action-button",{attrs:{icon:t.$icons.filter,title:"Setup filter rules"},on:{action:t.setup}})},wt=[],xt=a("4dc8"),St={name:"SetupFilterAction",computed:{forms:function(){var t=this.$store.getters["forms/getFormByName"]("pageblock");return[t.form_id]}},methods:{setup:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=1,et["a"].loadFilter();case 1:return e=t.sent,t.next=2,this.$dialogs.show(xt["a"],{value:e.QBRules,forms:this.forms});case 2:if(a=t.sent,"ok"!==a.trigger){t.next=4;break}return t.next=3,et["a"].saveFilter({QBRules:a.value});case 3:return t.next=4,this.$store.dispatch("rl/loadBlocks");case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},$t=St,Ct=Object(p["a"])($t,yt,wt,!1,null,null,null),Ot=Ct.exports,jt={name:"BlocksList",components:{NewBlockAction:kt,SearchBlockInput:ft,Container:C["Container"],Draggable:C["Draggable"],SetupFilterAction:Ot},data:function(){return{filter:""}},computed:{blocks:function(){var t=this,e=Object.values(this.$store.state.rl.blocks);return this.filter&&(e=e.filter((function(e){return e.react_title.toLowerCase().includes(t.filter.toLowerCase())}))),e.sort((function(t,e){return t.react_title.localeCompare(e.react_title)}))}},methods:{getChildPayload:function(t){return{react_id:this.blocks[t]["react_id"]}},getGhostParent:function(){return document.body}}},Rt=jt,At=(a("6d23"),Object(p["a"])(Rt,it,lt,!1,null,"f2c746ce",null)),Dt=At.exports,Bt={name:"LayoutSetup",components:{BlocksList:Dt,TemplateSlot:st},props:{},data:function(){return{}},computed:{template:function(){return this.$store.getters["rl/getTemplate"]},template_name:function(){return this.$store.getters["rl/getTemplateName"]},scope:function(){return this.$store.getters["rl/getScope"]},whatNeedSelect:function(){return(this.template_name?"":"layout template")+(this.template_name||this.scope?"":" and ")+(this.scope?"":" scope")}},methods:{}},Nt=Bt,Tt=(a("c2c1"),Object(p["a"])(Nt,y,w,!1,null,null,null)),It=Tt.exports,Lt={name:"ReactLayoutController",components:{SelectScope:k,LayoutSetup:It,SelectLayoutTemplate:f},props:{layout:{type:String,required:!0}},mounted:function(){this.load()},methods:{load:function(){this.$store.dispatch("rl/init",{layout:this.layout})}}},Ft=Lt,Pt=Object(p["a"])(Ft,r,s,!1,null,null,null),Vt=Pt.exports,Ht={name:"ReactLayoutView",components:{ReactLayoutController:Vt},props:["layout"]},Mt=Ht,qt=Object(p["a"])(Mt,o,n,!1,null,null,null);e["default"]=qt.exports},f611:function(t,e,a){}}]);
//# sourceMappingURL=chunk-7d060842.d24dffbc.js.map