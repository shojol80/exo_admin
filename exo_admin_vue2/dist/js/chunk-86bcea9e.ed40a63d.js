(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-86bcea9e"],{"0089":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e._self._c;return t("app-screen",[t("waiter",{ref:"waiter",attrs:{show:e.loading}},[t("action-table",{ref:"table",staticClass:"newsletters-table",attrs:{name:"newsletters","table-type":"server",columns:e.columns,options:e.options},on:{"row-click":e.showReport},scopedSlots:e._u([{key:"actions",fn:function(r){return[t("action-group",[t("action-button",{attrs:{title:"Refresh",icon:e.$icons.reload},on:{action:function(t){return e.load()}}})],1)]}},{key:"col-action",fn:function(r){var n=r.row;return[t("action-group",{on:{click:function(e){e.stopPropagation()}}},["new"===n.rn_status?t("action-button",{attrs:{title:"Terminate",icon:e.$icons.terminate},on:{action:function(t){return e.terminate([n])}}}):e._e()],1)]}},{key:"contextmenu",fn:function(r){var n=r.rows;return[t("x-context-menu-item",{attrs:{icon:e.$icons.terminate},on:{click:function(t){return e.terminate(n)}}},[e._v("\n                    Terminate\n                ")])]}},{key:"rn_date_created",fn:function(t){var r=t.row;return[e._v("\n                "+e._s(e.formatDate(r.rn_date_created))+"\n            ")]}},{key:"rn_date_scheduled",fn:function(t){var r=t.row;return[e._v("\n                "+e._s(e.formatDate(r.rn_date_scheduled))+"\n            ")]}},{key:"rn_date_done",fn:function(t){var r=t.row;return[e._v("\n                "+e._s(e.formatDate(r.rn_date_done))+"\n            ")]}}])})],1),t("mailreport",{ref:"report"})],1)},s=[],a=(r("96cf"),r("3b8d")),o=r("2c67"),i={getNewsletters:function(e,t){return o["a"].post.apply(o["a"],["/newsletters/getNewsletters"].concat(Array.prototype.slice.call(arguments)))},terminate:function(e,t){return o["a"].post.apply(o["a"],["/newsletters/terminate"].concat(Array.prototype.slice.call(arguments)))},getNewsletter:function(e,t){return o["a"].post.apply(o["a"],["/newsletters/getNewsletter"].concat(Array.prototype.slice.call(arguments)))}},c=function(){var e=this,t=e._self._c;return t("aside-panel",{ref:"modal",staticClass:"mailreport"},[t("waiter",[t("div",{staticClass:"mailreport__body"},[t("table",{staticClass:"table table-striped table-borderless table-sm"},[t("tr",[t("th",[e._v("Status")]),t("td",{class:{"text-success":"done"===e.newsletter.rn_status}},[e._v("\n                        "+e._s(e.newsletter.rn_status)+"\n                    ")])]),t("tr",[t("th",[e._v("Subject")]),t("td",[e._v(e._s(e.newsletter.rn_subject))])]),t("tr",[t("th",[e._v("From")]),t("td",[e._v("\n                        "+e._s(e.newsletter.rn_send_fromname)+"<"+e._s(e.newsletter.rn_send_from)+">\n                    ")])]),t("tr",[t("th",[e._v("To ")]),t("td",[e._v("group:"+e._s(e.newsletter.usergroup.ug_name))])]),t("tr",[t("th",[e._v("User")]),t("td",[e._v(e._s(e.newsletter.user.u_email))])]),t("tr",[t("th",[e._v("Send mails")]),t("td",[e._v("\n                        "+e._s(e.newsletter.rn_count_mails)+"\n                        "),+e.newsletter.rn_count_mails_error>0?t("span",{staticClass:"text-error"},[e._v("errors:"+e._s(e.newsletter.rn_count_mails_error))]):e._e()])]),t("tr",[t("th",[e._v("Bounces")]),t("td",[e._v(e._s(e.newsletter.rn_count_bounces))])]),t("tr",[t("th",[e._v("Users that react")]),t("td",[e._v(e._s(e.newsletter.rn_count_click_users))])]),t("tr",[t("th",[e._v("Users total clicks")]),t("td",[e._v(e._s(e.newsletter.rn_count_clicks))])])]),t("iframe",{ref:"iframe",attrs:{src:"javascript:void(0);",frameborder:"0"}})])])],1)},u=[],l=r("870c"),_={name:"Mailreport",components:{AsidePanel:l["a"]},data:function(){return{newsletter:{user:{},usergroup:{}}}},methods:{show:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.$refs.modal.show(),e.next=1,i.getNewsletter({rn_id:t});case 1:this.newsletter=e.sent,this.$refs.iframe.contentWindow.document.open("text/html","replace"),this.$refs.iframe.contentWindow.document.write(this.newsletter.rn_mail_body),this.$refs.iframe.contentWindow.document.close();case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},d=_,f=(r("ffa6"),r("2877")),m=Object(f["a"])(d,c,u,!1,null,"927c884e",null),p=m.exports,w=r("5a0c"),h=r.n(w),b=r("115e"),v={name:"NewslettersTable",components:{Mailreport:p},props:{},data:function(){return{loading:!1,columns:["rn_id","usergroup.ug_name","rn_subject","rn_status","rn_date_created","rn_date_scheduled","rn_date_done","col-action"],options:{useFilterSearchQuery:!0,useFilterByColumn:!0,filterableColumns:["rn_id","usergroup.ug_name","rn_status","rn_subject"],listColumns:{rn_status:[{id:"new",text:"new"},{id:"done",text:"done"},{id:"error",text:"error"},{id:"terminated",text:"terminated"}]},headings:{rn_id:"ID","usergroup.ug_name":"User group",rn_subject:"Subject",rn_status:"Status",rn_date_created:"Created",rn_date_scheduled:"Scheduled",rn_date_done:"Done"},orderBy:{ascending:!1,column:"rn_date_scheduled"},requestFunction:this.requestFunction,sortable:["rn_id","rn_subject","rn_status","rn_date_created","rn_date_scheduled","rn_date_done"],uniqueKey:"rn_id"}}},mounted:function(){this.load()},methods:{load:function(){this.$refs.table.refresh()},requestFunction:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=1,i.getNewsletters(t);case 1:return r=e.sent,this.loading=!1,e.abrupt("return",r);case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),showReport:function(e){this.$refs.report.show(e.row.rn_id)},terminate:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=1,this.$dialogs.confirmDelete({title:"Terminate newsletter",message:'Are you sure want to terminate newsletter "'.concat(t[0]["rn_subject"],'" (').concat(t[0]["rn_id"],")?")});case 1:if(r=e.sent,"ok"===r.trigger){e.next=2;break}return e.abrupt("return");case 2:return e.next=3,i.terminate({rn_id:t.map((function(e){return e.rn_id}))});case 3:return e.next=4,this.load();case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),formatDate:function(e){return Object(b["a"])(e)?null:h()(e).format("YYYY-MM-DD HH:mm")}}},g=v,y=(r("5aa2"),Object(f["a"])(g,n,s,!1,null,null,null));t["default"]=y.exports},"55bf":function(e,t,r){},"5aa2":function(e,t,r){"use strict";r("6734")},6734:function(e,t,r){},ffa6:function(e,t,r){"use strict";r("55bf")}}]);
//# sourceMappingURL=chunk-86bcea9e.ed40a63d.js.map