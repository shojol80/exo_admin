(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-32182820"],{"12d0":function(e,t,n){"use strict";var r=function(){var e=this,t=e._self._c;return t("dialog-modal",e._b({ref:"modal",attrs:{"ok-disabled":!e.localValue},on:{hide:e.onModalHide,hidden:e.onModalHidden}},"dialog-modal",e.$dialogsProps,!1),[t("x-select",e._b({attrs:{multiple:!1,options:e.tree},model:{value:e.localValue,callback:function(t){e.localValue=t},expression:"localValue"}},"x-select",e.treePropsDefault,!1))],1)},o=[],i=(n("8e6e"),n("ac6a"),n("cadf"),n("456d"),n("bd86")),s=n("e5a8");function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){Object(i["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c={name:"SelectDialog",mixins:[s["a"]],props:{tree:Array,multiple:!1,default:null,treeProps:{default:function(){return{clearable:!1}}}},computed:{treePropsDefault:function(){return u(u({},{clearable:!1}),this.treeProps)}},mounted:function(){this.localValue=this.default?this.default:null}},l=c,d=n("2877"),p=Object(d["a"])(l,r,o,!1,null,null,null);t["a"]=p.exports},"2a95":function(e,t,n){"use strict";n("eb453")},"2c13":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("waiter",{ref:"tableWaiter",attrs:{show:e.loading}},[t("action-table",{ref:"table",staticClass:"users-table",attrs:{name:"Users","table-type":"server",columns:e.columns,options:e.options},on:{"row-click":e.onRowClick},scopedSlots:e._u([{key:"filterDropdown",fn:function(){return[t("action-dropdown-item",{attrs:{active:!e.trashed},on:{click:function(t){return e.setFilter(!1)}}},[e._v("Active user\n            ")]),t("action-dropdown-item",{attrs:{active:e.trashed},on:{click:function(t){return e.setFilter(!0)}}},[e._v("Deleted users\n            ")])]},proxy:!0},{key:"actions",fn:function(n){return[t("action-group",[t("action-button",{attrs:{title:"New user",icon:e.$icons.new,shortkey:"['ctrl', 'o']"},on:{action:function(t){return e.onActionNew()}}}),t("action-button",{directives:[{name:"show",rawName:"v-show",value:n.rows&&1===n.rows.length,expression:"props.rows && props.rows.length===1"}],attrs:{disabled:!!e.trashed,title:"Edit user",icon:e.$icons.edit},on:{action:function(t){return e.onActionEdit(n.rows)}}}),t("action-button",{directives:[{name:"show",rawName:"v-show",value:n.rows&&n.rows.length>0,expression:"props.rows && props.rows.length>0"}],attrs:{title:"Delete user",icon:e.$icons.delete},on:{action:function(t){return e.onActionDelete(n.rows)}}}),t("action-button",{directives:[{name:"show",rawName:"v-show",value:n.rows&&n.rows.length>0,expression:"props.rows && props.rows.length>0"}],attrs:{disabled:!!e.trashed,title:"Add to group ...",icon:e.$icons.group_add},on:{action:function(t){return e.onActionAddToGroup(n.rows)}}}),t("action-button",{directives:[{name:"show",rawName:"v-show",value:n.rows&&n.rows.length>0&&e.ug_id>0,expression:"props.rows && props.rows.length>0 && ug_id>0"}],attrs:{disabled:!!e.trashed,title:"Remove from this group",icon:e.$icons.group_remove},on:{action:function(t){return e.onActionRemoveFromGroup(n.rows)}}}),t("action-group-separator"),t("action-button",{attrs:{title:"Reload",icon:e.$icons.reload},on:{action:e.load}})],1)]}},{key:"col-action",fn:function(n){return[t("action-group",{on:{click:function(e){e.stopPropagation()}}},[t("action-button",{attrs:{disabled:!!e.trashed,icon:e.$icons.edit},on:{action:function(t){return e.onActionEdit([n.row])}}}),t("action-button",{attrs:{icon:e.$icons.delete},on:{action:function(t){return e.onActionDelete([n.row])}}}),t("action-button",{attrs:{disabled:!!e.trashed,title:"Add to group",icon:e.$icons.group_add},on:{action:function(t){return e.onActionAddToGroup([n.row])}}}),t("action-button",{directives:[{name:"show",rawName:"v-show",value:e.ug_id>0,expression:"ug_id>0"}],attrs:{disabled:!!e.trashed,title:"Remove from this group",icon:e.$icons.group_remove},on:{action:function(t){return e.onActionRemoveFromGroup([n.row])}}})],1)]}},{key:"contextmenu",fn:function(n){return[t("x-context-menu-item",{directives:[{name:"show",rawName:"v-show",value:n.rows&&1===n.rows.length,expression:"props.rows && props.rows.length===1"}],attrs:{disabled:!!e.trashed,icon:e.$icons.edit},on:{click:function(t){return e.onActionEdit(n.rows)}}},[e._v("Edit\n            ")]),t("x-context-menu-item",{attrs:{icon:e.$icons.delete},on:{click:function(t){return e.onActionDelete(n.rows)}}},[e._v("\n                Delete\n            ")]),t("x-context-menu-item",{attrs:{disabled:!!e.trashed,icon:e.$icons.group_add},on:{click:function(t){return e.onActionAddToGroup(n.rows)}}},[e._v("\n                Add to group ...\n            ")]),t("x-context-menu-item",{directives:[{name:"show",rawName:"v-show",value:e.ug_id>0,expression:"ug_id>0"}],attrs:{disabled:!!e.trashed,icon:e.$icons.group_remove},on:{click:function(t){return e.onActionRemoveFromGroup(n.rows)}}},[e._v("\n                Remove from this group\n            ")])]}},{key:"u_email",fn:function(n){return[e._v("\n            "+e._s(n.row.u_email)+"\n            "),e.isMailhost(n.row.u_email)?["forward"===n.row.u_mailsize||n.row.u_ismailbox?t("b-badge",{staticClass:"ml-1"},[e._v("\n                    "+e._s(n.row.u_mailsize)+"\n                ")]):e._e()]:e._e(),e.isMailList(n.row.u_maildest)?t("b-badge",{staticClass:"ml-1"},[e._v("maillist")]):e._e()]}}])})],1)},o=[],i=(n("6762"),n("2fdb"),n("28a5"),n("96cf"),n("3b8d")),s=n("b991"),a=n("2f1b"),u=n("2c2f"),c=n("12d0"),l=function(){var e=this,t=e._self._c;return t("dialog-modal",e._b({ref:"modal",attrs:{variant:e.variant},on:{hide:e.onModalHideCustom,hidden:e.onModalHidden}},"dialog-modal",e.$dialogsProps,!1),[t("div",[t("p",{domProps:{innerHTML:e._s(e.message)}})]),t("div",{staticClass:"mt-3"},[t("b-form-radio-group",{attrs:{options:e.reactOptions,stacked:""},model:{value:e.reactAction,callback:function(t){e.reactAction=t},expression:"reactAction"}}),"transfer"===e.reactAction?t("div",{staticClass:"mt-3"},[t("label",{staticClass:"form-label"},[e._v("Or transfer them to another account:")]),t("select-user",{attrs:{"exclude-user-ids":e.excludeUserIds,placeholder:"user@example.com"},model:{value:e.transferToUserId,callback:function(t){e.transferToUserId=t},expression:"transferToUserId"}})],1):e._e()],1)])},d=[],p=n("e5a8"),f={name:"DeleteUserDialog",mixins:[p["a"]],props:{okTitle:{default:"DELETE"},variant:{default:"danger"},message:{default:"Do you want to delete User?"},excludeUserIds:{type:Array,default:function(){return[]}}},data:function(){return{reactAction:"delete",transferToUserId:null,reactOptions:[{text:"Delete reacts created by this account",value:"delete"},{text:"Transfer them to another account",value:"transfer"}]}},computed:{cascade:function(){return"delete"===this.reactAction}},methods:{onModalHideCustom:function(e){e.cascade=this.cascade,e.transferToUserId="transfer"===this.reactAction?this.transferToUserId:null,this.onModalHide(e)}}},h=f,m=n("2877"),g=Object(m["a"])(h,l,d,!1,null,"4d0f8d4e",null),w=g.exports,b={name:"UsersTable",props:{ug_id:null},data:function(){return{trashed:!1,loading:!1,searchQuery:"",columns:["col-check","u_id","u_email","react_count","u_lastlogin","col-action"],options:{useFilterSearchQuery:!0,useFilterByColumn:!0,filterableColumns:["u_id","u_email"],requestFunction:this.requestFunction,sortable:["u_id","u_email","u_lastlogin"],uniqueKey:"u_id",headings:{u_id:"ID",u_email:"Email",react_count:"Reacts",u_lastlogin:"Last login"}}}},computed:{mailhosts:function(){return this.$store.getters["pages/getMailhosts"]}},watch:{ug_id:function(e,t){},$route:function(e,t){this._inactive||this.load()}},mounted:function(){},methods:{requestFunction:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.ug_id&&0!==+this.ug_id&&(t.ug_id=this.ug_id),this.trashed&&(t.trashed=!0),t["react_count"]=1,e.prev=1,this.loading=!0,e.next=2,u["a"].getUsers(t);case 2:return e.abrupt("return",e.sent);case 3:return e.prev=3,this.loading=!1,e.finish(3);case 4:case"end":return e.stop()}}),e,this,[[1,,3,4]])})));function t(t){return e.apply(this,arguments)}return t}(),load:function(){this.$refs.table.refresh()},onActionNew:function(){this.$router.push({name:s["O"],params:{u_id:"new",ug_id:this.ug_id}})},onActionDelete:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var n,r,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.trashed){e.next=1;break}return this.$awn.alert("Not implemented!"),e.abrupt("return");case 1:return r=1===t.length?"Are you sure you want to delete account <b>".concat(t[0]["u_email"],"</b>?"):'Are you sure want to delete "'.concat(t.length,'" users?'),o=t.map((function(e){return e["u_id"]})),n={u_id:o},e.next=2,this.$dialogs.show(w,{message:r,excludeUserIds:o});case 2:if(i=e.sent,"ok"===i.trigger){e.next=3;break}return e.abrupt("return");case 3:return n.cascade=i.cascade||!1,i.transferToUserId&&(n.transferToUserId=i.transferToUserId),e.next=4,u["a"].deleteUser(n);case 4:return e.next=5,this.load();case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),onActionEdit:function(e){this.trashed||this.$router.push({name:s["O"],params:{u_id:e[0]["u_id"],ug_id:this.ug_id}})},onActionAddToGroup:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=Object(a["a"])(this.$store.getters["usergroups/usergroupsTree"],{ug_id:"id",ug_name:"label",ug_children:"children"},"ug_children"),e.next=1,this.$dialogs.show(c["a"],{title:"Add to a user group",tree:n});case 1:if(r=e.sent,"ok"===r.trigger){e.next=2;break}return e.abrupt("return");case 2:return o=t.map((function(e){return e["u_id"]})),e.next=3,u["a"].addUsersToUsergroup({ug_id:r.value,u_id:o});case 3:return e.next=4,this.load();case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),onActionRemoveFromGroup:function(e){var t=this;if(0!==e.length){var n=e.length>1?"Do you want remove <b>".concat(e.length,"</b> users from this group?"):"Do you want remove user <b>".concat(e[0]["u_email"],"</b> from this group?");this.$dialogs.confirm({okTitle:"REMOVE",message:n}).then((function(n){if("ok"===n.trigger){var r=e.map((function(e){return e["u_id"]}));u["a"].removeUsersFromUsergroup({ug_id:t.ug_id,u_id:r}).then((function(){return t.load()}))}}))}},onRowClick:function(e){this.onActionEdit([e.row])},setFilter:function(e){this.trashed=e,this.load()},isMailList:function(e){return!!e&&e.split("|").some((function(e){return e.includes("maillisting")}))},isMailhost:function(e){if(!e)return!1;var t=e.split("@")[1];return this.mailhosts.includes(t)}}},v=b,_=(n("2a95"),Object(m["a"])(v,r,o,!1,null,null,null));t["default"]=_.exports},"2f1b":function(e,t,n){"use strict";n("456d"),n("ac6a"),n("cadf"),n("8615");var r=n("7618");function o(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Array.isArray(e)||"object"!==Object(r["a"])(e)||(e=Object.values(e)),e.map((function(e){var r={};return Object.keys(t).map((function(s){if(s===n){if(!i&&0===e[s].length)return;return r[t[s]]=o(e[s],t,n)}return r[t[s]]=e[s]})),r}))}t["a"]=o},eb453:function(e,t,n){}}]);
//# sourceMappingURL=chunk-32182820.db3845b8.js.map