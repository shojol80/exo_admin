(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11e2e364"],{"0162":function(o,e,t){"use strict";t.r(e);var r=function(){var o=this,e=o._self._c;return e("waiter",{ref:"tableWaiter"},[e("action-table",{ref:"table",staticClass:"forms-table",attrs:{name:"Forms","table-type":"server",columns:o.columns,options:o.options},on:{"row-click":o.onRowClick},scopedSlots:o._u([{key:"actions",fn:function(t){return[e("action-group",[e("action-button",{attrs:{title:"New form",icon:o.$icons.new,shortkey:"['ctrl', 'o']"},on:{action:function(e){return o.onActionNew()}}}),e("action-button",{directives:[{name:"show",rawName:"v-show",value:t.rows&&1===t.rows.length,expression:"props.rows && props.rows.length===1"}],attrs:{title:"Edit form",icon:o.$icons.edit},on:{action:function(e){return o.onActionEdit(t.rows)}}}),e("action-button",{directives:[{name:"show",rawName:"v-show",value:t.rows&&t.rows.length>0,expression:"props.rows && props.rows.length>0"}],attrs:{title:"Delete form",icon:o.$icons.delete},on:{action:function(e){return o.onActionDelete(t.rows)}}}),e("action-button",{directives:[{name:"show",rawName:"v-show",value:t.rows&&t.rows.length>0,expression:"props.rows && props.rows.length>0"}],attrs:{title:"Add to group ...",icon:o.$icons.group_add},on:{action:function(e){return o.onActionAddToGroup(t.rows)}}}),e("action-button",{directives:[{name:"show",rawName:"v-show",value:t.rows&&t.rows.length>0&&o.group_id>0,expression:"props.rows && props.rows.length>0 && group_id>0"}],attrs:{title:"Remove from this group",icon:o.$icons.group_remove},on:{action:function(e){return o.onActionRemoveFromGroup(t.rows)}}}),e("action-group-separator"),e("action-button",{attrs:{title:"Reload",icon:o.$icons.reload},on:{action:o.load}})],1)]}},{key:"col-action",fn:function(t){return[e("action-group",{on:{click:function(o){o.stopPropagation()}}},[e("action-button",{attrs:{title:"Delete form",icon:o.$icons.delete},on:{action:function(e){return o.onActionDelete([t.row])}}}),e("action-button",{attrs:{title:"Add to group",icon:o.$icons.group_add},on:{action:function(e){return o.onActionAddToGroup([t.row])}}}),e("action-button",{directives:[{name:"show",rawName:"v-show",value:o.group_id>0,expression:"group_id>0"}],attrs:{title:"Remove from this group",icon:o.$icons.group_remove},on:{action:function(e){return o.onActionRemoveFromGroup([t.row])}}})],1)]}},{key:"contextmenu",fn:function(t){return[e("x-context-menu-item",{directives:[{name:"show",rawName:"v-show",value:t.rows&&1===t.rows.length,expression:"props.rows && props.rows.length===1"}],attrs:{icon:o.$icons.edit},on:{click:function(e){return o.onActionEdit(t.rows)}}},[o._v("\n                Edit\n            ")]),e("x-context-menu-item",{attrs:{icon:o.$icons.delete},on:{click:function(e){return o.onActionDelete(t.rows)}}},[o._v("\n                Delete\n            ")]),e("x-context-menu-item",{attrs:{icon:o.$icons.group_add},on:{click:function(e){return o.onActionAddToGroup(t.rows)}}},[o._v("\n                Add to group ...\n            ")]),e("x-context-menu-item",{directives:[{name:"show",rawName:"v-show",value:o.group_id>0,expression:"group_id>0"}],attrs:{icon:o.$icons.group_remove},on:{click:function(e){return o.onActionRemoveFromGroup(t.rows)}}},[o._v("\n                Remove from this group\n            ")])]}}])})],1)},n=[],i=(t("7f7f"),t("96cf"),t("3b8d")),a=(t("ac6a"),t("cadf"),t("8615"),t("fb4c")),c=t("b991"),u=t("2f1b"),s=t("4cb8"),l=t("95e4"),p=t("12d0"),f={name:"FormsTable",components:{ContextMenu:l["a"]},props:{group_id:null},data:function(){return{group_type:"form",columns:["col-check","form_id","form_name","form_info","col-action"],options:{useFilterSearchQuery:!0,useFilterByColumn:!0,filterableColumns:["form_id","form_name","form_info"],requestFunction:this.requestFunction,debounce:500,sortable:["form_id","form_name","form_info"],uniqueKey:"form_id",headings:{form_id:"ID",form_name:"Name",form_info:"Info"}}}},computed:{presetForms:function(){return Object.values(this.ECO.forms.preset_form)}},watch:{group_id:function(o,e){o!==e&&this.load()}},methods:{requestFunction:function(){var o=Object(i["a"])(regeneratorRuntime.mark((function o(e){return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return this.group_id&&0!==+this.group_id&&(e.group_id=this.group_id),o.prev=1,this.loading=!0,o.next=2,a["a"].getForms(e);case 2:return o.abrupt("return",o.sent);case 3:return o.prev=3,this.loading=!1,o.finish(3);case 4:case"end":return o.stop()}}),o,this,[[1,,3,4]])})));function e(e){return o.apply(this,arguments)}return e}(),load:function(){this.$refs.table.refresh()},onActionNew:function(){var o=Object(i["a"])(regeneratorRuntime.mark((function o(){var e;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=1,this.$dialogs.show(p["a"],{title:"Select a predefined form",tree:this.presetForms,default:this.presetForms[0]["name"],treeProps:{idKey:"name",labelKey:"name"}});case 1:if(e=o.sent,"ok"===e.trigger){o.next=2;break}return o.abrupt("return");case 2:return o.next=3,this.$router.push({name:c["s"],params:{form_id:"new",group_id:this.group_id},query:{preset:e.value}});case 3:case"end":return o.stop()}}),o,this)})));function e(){return o.apply(this,arguments)}return e}(),onActionDelete:function(o){var e,t,r=this;1===o.length?(t='Are you sure want to delete form "'.concat(o[0]["form_name"],'"?'),e=o[0]):(t='Are you sure want to delete "'.concat(o.length,'" forms?'),e={form_id:o.map((function(o){return o["form_id"]}))}),this.$dialogs.confirmDelete({title:"Delete form",message:t}).then((function(o){"ok"===o.trigger&&a["a"].deleteForm(e).then(r.load)}))},onActionEdit:function(o){this.$router.push({name:c["s"],params:{form_id:o[0]["form_id"]}})},onActionAddToGroup:function(o){var e=this;s["a"].getGroupTree({group_type:this.group_type}).then((function(o){return Object(u["a"])(o,{group_id:"id",group_name:"label",children:"children"},"children")})).then((function(t){e.$dialogs.show(p["a"],{title:"Add to group",tree:t}).then((function(t){if("ok"===t.trigger){var r=o.map((function(o){return o["form_id"]}));s["a"].addRelation({group_type:e.group_type,r_obj:r,group_id:t.value}).then((function(){return e.load()}))}}))}))},onActionRemoveFromGroup:function(o){var e=this;if(0!==o.length){var t=o.length>1?"Do you want remove <b>".concat(o.length,"</b> forms from this group?"):"Do you want remove form <b>".concat(o[0]["form_name"],"</b> from this group?");this.$dialogs.confirm({okTitle:"REMOVE",message:t}).then((function(t){if("ok"===t.trigger){var r=o.map((function(o){return o["form_id"]}));s["a"].removeRelation({group_type:e.group_type,r_obj:r,group_id:e.group_id}).then((function(){return e.load()}))}}))}},onRowClick:function(o){this.onActionEdit([o.row])}}},d=f,m=(t("3bd5"),t("2877")),g=Object(m["a"])(d,r,n,!1,null,null,null);e["default"]=g.exports},"12d0":function(o,e,t){"use strict";var r=function(){var o=this,e=o._self._c;return e("dialog-modal",o._b({ref:"modal",attrs:{"ok-disabled":!o.localValue},on:{hide:o.onModalHide,hidden:o.onModalHidden}},"dialog-modal",o.$dialogsProps,!1),[e("x-select",o._b({attrs:{multiple:!1,options:o.tree},model:{value:o.localValue,callback:function(e){o.localValue=e},expression:"localValue"}},"x-select",o.treePropsDefault,!1))],1)},n=[],i=(t("8e6e"),t("ac6a"),t("cadf"),t("456d"),t("bd86")),a=t("e5a8");function c(o,e){var t=Object.keys(o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(o);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}))),t.push.apply(t,r)}return t}function u(o){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?c(Object(t),!0).forEach((function(e){Object(i["a"])(o,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(t,e))}))}return o}var s={name:"SelectDialog",mixins:[a["a"]],props:{tree:Array,multiple:!1,default:null,treeProps:{default:function(){return{clearable:!1}}}},computed:{treePropsDefault:function(){return u(u({},{clearable:!1}),this.treeProps)}},mounted:function(){this.localValue=this.default?this.default:null}},l=s,p=t("2877"),f=Object(p["a"])(l,r,n,!1,null,null,null);e["a"]=f.exports},"2f1b":function(o,e,t){"use strict";t("456d"),t("ac6a"),t("cadf"),t("8615");var r=t("7618");function n(o,e,t){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Array.isArray(o)||"object"!==Object(r["a"])(o)||(o=Object.values(o)),o.map((function(o){var r={};return Object.keys(e).map((function(a){if(a===t){if(!i&&0===o[a].length)return;return r[e[a]]=n(o[a],e,t)}return r[e[a]]=o[a]})),r}))}e["a"]=n},"3bd5":function(o,e,t){"use strict";t("e283")},"4cb8":function(o,e,t){"use strict";var r=t("2c67");e["a"]={deleteGroup:function(o,e){return r["a"].post.apply(r["a"],["/groups/deleteGroup"].concat(Array.prototype.slice.call(arguments)))},getGroup:function(o,e){return r["a"].post.apply(r["a"],["/groups/getGroup"].concat(Array.prototype.slice.call(arguments)))},saveGroup:function(o,e){return r["a"].post.apply(r["a"],["/groups/saveGroup"].concat(Array.prototype.slice.call(arguments)))},getGroupTree:function(o,e){return r["a"].post.apply(r["a"],["/groups/getGroupTree"].concat(Array.prototype.slice.call(arguments)))},removeRelation:function(o,e){return r["a"].post.apply(r["a"],["/groups/removeRelation"].concat(Array.prototype.slice.call(arguments)))},addRelation:function(o,e){return r["a"].post.apply(r["a"],["/groups/addRelation"].concat(Array.prototype.slice.call(arguments)))}}},e283:function(o,e,t){}}]);
//# sourceMappingURL=chunk-11e2e364.9d375ba0.js.map