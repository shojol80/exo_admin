(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-498f367c"],{"04ef":function(e,t,r){"use strict";var a=function(){var e=this,t=e._self._c;return t("vue-query-builder",e._g(e._b({staticClass:"x-query-builder",scopedSlots:e._u([e._l(e.$scopedSlots,(function(t,r){return{key:r,fn:function(t){return[e._t(r,null,null,t)]}}}))],null,!0)},"vue-query-builder",e.$attrs,!1),e.$listeners),[e._l(e.$slots,(function(t,r){return e._t(r,null,{slot:r})}))],2)},n=[],o=(r("54d8"),r("9a97")),l=r.n(o),s={name:"XQueryBuilder",components:{VueQueryBuilder:l.a}},u=s,i=(r("cfc4"),r("2877")),c=Object(i["a"])(u,a,n,!1,null,null,null);t["a"]=c.exports},"1ec3":function(e,t,r){},"1ecc":function(e,t,r){"use strict";r("1ec3")},"57ea":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("app-screen",[t("waiter",{ref:"waiter",staticClass:"schedule"},[t("ValidationObserver",{ref:"observer",scopedSlots:e._u([{key:"default",fn:function(r){r.invalid;return[t("action-toolbar",[t("action-group",{staticClass:"mr-2"},[t("action-back",{attrs:{"back-route":e.backRoute}}),t("action-group-separator"),t("action-button",{attrs:{title:"Save",icon:e.$icons.save,shortkey:"['ctrl', 's']"},on:{action:e.save}}),t("action-button",{attrs:{disabled:"new"===e.schedule_id,title:"Reload",icon:e.$icons.reload},on:{action:e.load}})],1)],1),t("b-card",{staticClass:"mt-3",attrs:{"no-header":"","no-footer":""}},[t("x-form-fieldset",[t("ValidationProvider",{attrs:{slim:"",name:"command",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.errors,n=r.valid;return[t("x-form-select",{attrs:{title:"Command",options:e.commandsOptions,"id-key":"name",valid:n,errors:a,"label-key":"description","db-field":"command"},on:{select:e.onSelectCommand},scopedSlots:e._u([{key:"option-label",fn:function(r){var a=r.node,n=r.labelClassName;return[t("label",{class:n},[t("span",{staticClass:"font-weight-bold"},[e._v(e._s(a.id))]),e._v(" - "+e._s(a.label)+"\n                                ")])]}},{key:"value-label",fn:function(r){var a=r.node;return[t("span",{staticClass:"font-weight-bold"},[e._v(e._s(a.id))]),e._v(" - "+e._s(a.label)+"\n                            ")]}}],null,!0),model:{value:e.schedule.command,callback:function(t){e.$set(e.schedule,"command",t)},expression:"schedule.command"}})]}}],null,!0)}),e.commandObject&&e.commandObject.arguments&&e.commandObject.arguments.length?t("x-form-group",{attrs:{title:"Arguments"}},[t("command-arguments",{attrs:{"command-object":e.commandObject},model:{value:e.schedule.params,callback:function(t){e.$set(e.schedule,"params",t)},expression:"schedule.params"}})],1):e._e(),e.commandObject&&e.commandObject.options&&e.commandObject.options.withValue.length?t("x-form-group",{attrs:{title:"Options with Value"}},[t("command-options",{attrs:{"command-object":e.commandObject},model:{value:e.schedule.options,callback:function(t){e.$set(e.schedule,"options",t)},expression:"schedule.options"}})],1):e._e(),e.commandObject&&e.commandObject.options&&e.commandObject.options.withoutValue.length?t("x-form-group",{attrs:{title:"Options"}},[t("command-options-no-value",{attrs:{"command-object":e.commandObject},model:{value:e.schedule.options,callback:function(t){e.$set(e.schedule,"options",t)},expression:"schedule.options"}})],1):e._e(),t("ValidationProvider",{attrs:{slim:"",name:"expression"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.errors,n=r.valid;return[t("x-form-input",{attrs:{valid:n,errors:a,title:"Cron Expression","db-field":"expression"},scopedSlots:e._u([{key:"description",fn:function(){return[t("a",{attrs:{href:"https://crontab.cronhub.io/",target:"_blank"}},[e._v("If necessary click here and\n                                    use a\n                                    tool to facilitate the creation of the cron expression")])]},proxy:!0}],null,!0),model:{value:e.schedule.expression,callback:function(t){e.$set(e.schedule,"expression",t)},expression:"schedule.expression"}})]}}],null,!0)}),t("x-form-input",{attrs:{title:"Log filename","db-field":"log_filename",description:"If log file is set, the log messages from this cron are written to storage/logs/<log filename>.log"},model:{value:e.schedule.log_filename,callback:function(t){e.$set(e.schedule,"log_filename",t)},expression:"schedule.log_filename"}}),t("x-form-input",{attrs:{title:"URL Before","db-field":"webhook_before"},model:{value:e.schedule.webhook_before,callback:function(t){e.$set(e.schedule,"webhook_before",t)},expression:"schedule.webhook_before"}}),t("x-form-input",{attrs:{title:"URL After","db-field":"webhook_after"},model:{value:e.schedule.webhook_after,callback:function(t){e.$set(e.schedule,"webhook_after",t)},expression:"schedule.webhook_after"}}),t("ValidationProvider",{attrs:{slim:"",name:"email_output"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.errors,n=r.valid;return[t("x-form-input",{attrs:{valid:n,errors:a,title:"Email for sending output","db-field":"email_output"},model:{value:e.schedule.email_output,callback:function(t){e.$set(e.schedule,"email_output",t)},expression:"schedule.email_output"}})]}}],null,!0)}),t("x-form-switch",{attrs:{title:"Send email in case of success to execute the command","label-position":"right","db-field":"sendmail_success"},model:{value:e.schedule.sendmail_success,callback:function(t){e.$set(e.schedule,"sendmail_success",t)},expression:"schedule.sendmail_success"}}),t("x-form-switch",{attrs:{title:"Send email in case of failure to execute the command","label-position":"right","db-field":"sendmail_error"},model:{value:e.schedule.sendmail_error,callback:function(t){e.$set(e.schedule,"sendmail_error",t)},expression:"schedule.sendmail_error"}}),t("x-form-switch",{attrs:{title:"Write command output into history table in case of success to execute the command","label-position":"right","db-field":"log_success"},model:{value:e.schedule.log_success,callback:function(t){e.$set(e.schedule,"log_success",t)},expression:"schedule.log_success"}}),t("x-form-switch",{attrs:{title:"Write command output into history table in case of failure to execute the command","label-position":"right","db-field":"log_error"},model:{value:e.schedule.log_error,callback:function(t){e.$set(e.schedule,"log_error",t)},expression:"schedule.log_error"}}),t("x-form-switch",{attrs:{title:"Even in maintenance mode","label-position":"right","db-field":"even_in_maintenance_mode"},model:{value:e.schedule.even_in_maintenance_mode,callback:function(t){e.$set(e.schedule,"even_in_maintenance_mode",t)},expression:"schedule.even_in_maintenance_mode"}}),t("x-form-switch",{attrs:{title:"Without overlapping","label-position":"right","db-field":"without_overlapping"},model:{value:e.schedule.without_overlapping,callback:function(t){e.$set(e.schedule,"without_overlapping",t)},expression:"schedule.without_overlapping"}}),t("x-form-switch",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{title:"Execute scheduling only on one server","label-position":"right","db-field":"on_one_server"},model:{value:e.schedule.on_one_server,callback:function(t){e.$set(e.schedule,"on_one_server",t)},expression:"schedule.on_one_server"}}),t("x-form-switch",{attrs:{title:"Run in background","label-position":"right","db-field":"run_in_background"},model:{value:e.schedule.run_in_background,callback:function(t){e.$set(e.schedule,"run_in_background",t)},expression:"schedule.run_in_background"}})],1)],1)]}}])})],1)],1)},n=[],o=(r("8e6e"),r("456d"),r("7f7f"),r("a481"),r("bd86")),l=(r("96cf"),r("3b8d")),s=(r("ac6a"),r("cadf"),r("8615"),r("b991")),u=r("e74a"),i=r("9ea0"),c=function(){var e=this,t=e._self._c;return t("b-form-checkbox-group",{attrs:{options:e.commandObject.options.withoutValue,stacked:""},model:{value:e.localValue,callback:function(t){e.localValue=t},expression:"localValue"}})},d=[],m={name:"command-options-no-value",props:{commandObject:{},value:{}},data:function(){return{localValue:[]}},watch:{value:{immediate:!0,deep:!0,handler:function(){var e=this,t=Object.keys(this.value).reduce((function(t,r){return _.isObject(e.value[r])||t.push(r),t}),[]);_.isEqual(this.localValue,t)||(this.localValue=t)}},localValue:{deep:!0,handler:function(){var e=this,t=Object.keys(this.value).reduce((function(t,r){return _.isObject(e.value[r])&&(t[r]=e.value[r]),t}),{});this.localValue.forEach((function(e){t[e]="on"})),this.$emit("input",t)}}}},p=m,f=r("2877"),h=Object(f["a"])(p,c,d,!1,null,null,null),v=h.exports,b=function(){var e=this,t=e._self._c;return t("div",[e._l(e.commandObject.options.withValue,(function(r){return[t("div",{staticClass:"row"},[t("div",{staticClass:"col-8 form-group"},[t("label",[e._v(e._s(r.name))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.localValue[r.name].value,expression:"localValue[option.name].value"}],staticClass:"form-control",attrs:{type:"text",name:"options[".concat(r.name,"][value]"),required:r.required},domProps:{value:e.localValue[r.name].value},on:{input:function(t){t.target.composing||e.$set(e.localValue[r.name],"value",t.target.value)}}})]),t("div",{staticClass:"col-4 form-group"},[t("label",[e._v("Data type")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.localValue[r.name].type,expression:"localValue[option.name].type"}],staticClass:"form-control",attrs:{name:"options[".concat(r.name,"][type]")},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.localValue[r.name],"type",t.target.multiple?a:a[0])}}},[t("option",{attrs:{value:"string"}},[e._v("String")]),t("option",{attrs:{value:"function"}},[e._v("Function")])])])])]}))],2)},g=[],y=r("115e"),x={name:"command-options",props:{commandObject:{},value:{}},data:function(){return{localValue:{}}},watch:{value:{immediate:!0,handler:function(){_.isEqual(this.localValue,this.value)||(this.localValue=_.cloneDeep(this.value))}},localValue:{deep:!0,handler:function(){Object(y["a"])(this.localValue)||this.$emit("input",this.localValue)}}}},w=x,O=Object(f["a"])(w,b,g,!1,null,null,null),k=O.exports,j=function(){var e=this,t=e._self._c;return t("div",[e._l(e.commandObject.arguments,(function(r){return[t("div",{staticClass:"row"},[t("div",{staticClass:"col-8 form-group"},[t("label",[e._v(e._s(r.name))]),e.localValue&&e.localValue[r.name]?t("input",{directives:[{name:"model",rawName:"v-model",value:e.localValue[r.name].value,expression:"localValue[argument.name].value"}],staticClass:"form-control",attrs:{type:"text",name:"params[".concat(r.name,"][value]"),required:r.required},domProps:{value:e.localValue[r.name].value},on:{input:function(t){t.target.composing||e.$set(e.localValue[r.name],"value",t.target.value)}}}):e._e()]),t("div",{staticClass:"col-4 form-group"},[t("label",[e._v("Data type")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.localValue[r.name].type,expression:"localValue[argument.name].type"}],staticClass:"form-control",attrs:{name:"params[".concat(r.name,"][type]")},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.localValue[r.name],"type",t.target.multiple?a:a[0])}}},[t("option",{attrs:{value:"string"}},[e._v("String")]),t("option",{attrs:{value:"function"},domProps:{selected:"function"===(arguments&&arguments.hasOwnProperty(r.name)?arguments[r.name].type:"")}},[e._v("\n                        Function\n                    ")])])])])]}))],2)},q=[],$={name:"CommandArguments",props:{commandObject:{},value:{}},data:function(){return{localValue:{}}},watch:{value:{immediate:!0,handler:function(){_.isEqual(this.localValue,this.value)||(this.localValue=_.cloneDeep(this.value))}},localValue:{deep:!0,handler:function(){Object(y["a"])(this.localValue)||this.$emit("input",this.localValue)}}}},V=$,E=Object(f["a"])(V,j,q,!1,null,null,null),A=E.exports;function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var P={name:"Schedule",components:{RuleBuilder:i["a"],CommandOptionsNoValue:v,CommandOptions:k,CommandArguments:A},props:{schedule_id:{required:!0}},data:function(){return{backRoute:s["z"],schedule:{id:null,command:null,command_custom:"",params:[],options:{},expression:"* * * * *",webhook_before:"",webhook_after:"",email_output:"",status:"1",log_filename:"",groups:"",environments:"",sendmail_error:!1,sendmail_success:!1,log_success:!1,log_error:!1,even_in_maintenance_mode:!1,without_overlapping:!1,on_one_server:!1,run_in_background:!1},commands:[]}},computed:{commandObject:function(){return this.commands[this.schedule.command]},commandsOptions:function(){return Object.values(this.commands)}},watch:{schedule_id:function(){this.load()}},mounted:function(){this.loadCommands(),this.load(),this.$store.dispatch("breadcrumb/updateLast",{label:"Edit schedule: ".concat(this.$route.params.schedule_id)})},methods:{load:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.schedule_id){e.next=1;break}return this.$awn.alert('Prop "schedule_id" is not defined!'),e.abrupt("return");case 1:if("new"!==this.schedule_id){e.next=2;break}return e.abrupt("return");case 2:return e.next=3,this.$refs.waiter.wait(Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=1,u["a"].getSchedule({id:t.schedule_id});case 1:t.schedule=e.sent;case 2:case"end":return e.stop()}}),e)}))));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),save:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=1,this.$refs.observer.validate();case 1:if(e.sent){e.next=2;break}return e.abrupt("return");case 2:return e.next=3,this.$refs.waiter.wait(Object(l["a"])(regeneratorRuntime.mark((function e(){var r,a,n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,u["a"].saveSchedule(S({},t.schedule));case 1:if(r=e.sent,t.$emit("save"),"new"!==t.schedule_id){e.next=3;break}return e.next=2,t.$router.replace({name:s["A"],params:{schedule_id:r.id},query:t.$route.query});case 2:e.next=4;break;case 3:return e.next=4,t.load();case 4:e.next=7;break;case 5:if(e.prev=5,o=e["catch"](0),422!==_.get(o,"response.status")){e.next=6;break}a=o.response,n=a.data.errors,t.$refs.observer.setErrors(n),e.next=7;break;case 6:throw o;case 7:case"end":return e.stop()}}),e,null,[[0,5]])}))));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),loadCommands:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=1,u["a"].commands();case 1:this.commands=e.sent;case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onSelectCommand:function(e){this.setDefaultParams(e),this.setDefaultOptionsValue(e)},setDefaultParams:function(e){var t={};if(e&&e.arguments){var r=e.arguments;r.forEach((function(e){t[e.name]={type:"string",value:e.default}}))}this.schedule.params=t},setDefaultOptionsValue:function(e){var t={};if(e&&e.options&&e.options.withValue){var r=e.options.withValue;r.forEach((function(e){t[e.name]={type:"string",value:e.default}}))}this.schedule.options=t}}},R=P,D=Object(f["a"])(R,a,n,!1,null,null,null);t["default"]=D.exports},8224:function(e,t,r){},"9ea0":function(e,t,r){"use strict";var a=function(){var e=this,t=e._self._c;return t("rule-adapter",{staticClass:"rule-builder",attrs:{rules:e.rulesDefinition,rule_operator:e.rule_operator,"max-depth":3},on:{"update:rule_operator":function(t){e.rule_operator=t}},model:{value:e.rule_if,callback:function(t){e.rule_if=t},expression:"rule_if"}})},n=[],o=r("75fc"),l=function(){var e=this,t=e._self._c;return t("div",[t("b-input",e._g(e._b({directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}]},"b-input",e.$attrs,!1),e.$listeners))],1)},s=[],u=(r("6762"),r("2fdb"),{name:"FieldRuleInput",computed:{show:function(){return!["is EMPTY","is NOT EMPTY","is CHANGED"].includes(this.$parent.query.operator)}}}),i=u,c=r("2877"),d=Object(c["a"])(i,l,s,!1,null,"18eadda3",null),m=d.exports,p=function(){var e=this,t=e._self._c;return t("x-query-builder",e._b({model:{value:e.query,callback:function(t){e.query=t},expression:"query"}},"x-query-builder",e.$attrs,!1))},f=[],h=r("04ef"),_=r("2ef0"),v={"=":"is EQUAL","!=":"is NOT EQUAL",empty:"is EMPTY","!empty":"is NOT EMPTY",changed:"is CHANGED"};function b(e){var t=e.rule_if,r=e.rule_operator;t||(t=[]);var a=t.reduce((function(e,t){return t.rule_if?e.push({type:"query-builder-group",query:b({rule_if:t.rule_if,rule_operator:t.rule_operator})}):"__react"===t.field_name?e.push({type:"query-builder-rule",query:{operand:"REACT",operator:void 0,rule:t.field_name,value:t.exp}}):e.push({type:"query-builder-rule",query:{operand:t.field_name,operator:v[t.exp]||t.exp,rule:"__"+t.field_name,value:t.field_value}}),e}),[]);return{logicalOperator:r,children:a}}var g={"is EQUAL":"=","is NOT EQUAL":"!=","is EMPTY":"empty","is NOT EMPTY":"!empty","is CHANGED":"changed"};function y(e){return e.children.reduce((function(e,t){return"query-builder-group"===t.type?e.push({rule_if:y(t.query),rule_operator:t.query.logicalOperator}):"__react"===t.query.rule?e.push({field_name:t.query.rule,field_value:"",exp:t.query.value}):e.push({field_name:t.query.operand,field_value:t.query.value,exp:g[t.query.operator]||t.query.operator}),e}),[])}var x={name:"RuleAdapter",components:{XQueryBuilder:h["a"]},model:{prop:"rule_if",event:"input"},props:{rule_if:{type:Array,required:!0,default:function(){return[]}},rule_operator:{type:String,required:!0,default:"any"}},data:function(){return{query:{children:null,logicalOperator:null}}},watch:{rule_if:{deep:!0,immediate:!0,handler:function(){var e=b({rule_if:this.rule_if,rule_operator:this.rule_operator});this.query.children=e.children}},rule_operator:{immediate:!0,handler:function(){this.query.logicalOperator=this.rule_operator}},query:function(){var e=y(this.query);Object(_["isEqual"])(e,this.rule_if)||this.$emit("input",e),this.rule_operator!==this.query.logicalOperator&&this.$emit("update:rule_operator",this.query.logicalOperator)}}},w=x,O=Object(c["a"])(w,p,f,!1,null,"16c71e16",null),k=O.exports,j={name:"RuleBuilder",components:{RuleAdapter:k},computed:{rules:function(){return this.$store.getters["controller/formActions/rules"]},rule_if:{get:function(){return this.rules.rule_if},set:function(e){this.$store.commit("controller/formActions/setRule",{rule:"rule_if",value:e})}},rule_operator:{get:function(){return this.rules.rule_operator},set:function(e){this.$store.commit("controller/formActions/setRule",{rule:"rule_operator",value:e})}},form:function(){return this.$store.getters["forms/getForm"](this.$store.getters["controller/getActionFormId"])},form_questions:function(){return this.form?this.form.form_questions:[]},fqtArrayId:function(){return this.$store.getters["ECO/fqtArrayId"]},rulesDefinition:function(){return[{type:"radio",id:"__react",label:"REACT",choices:[{label:"CHANGED",value:"changed"},{label:"DELETED",value:"deleted"}]}].concat(Object(o["a"])(this.form_questions.map((function(e){return{type:"custom-component",id:"__"+e.fq_name,label:e.fq_name,operators:["is EQUAL","is NOT EQUAL","is EMPTY","is NOT EMPTY","is CHANGED",">","<",">=","<="],component:m,default:""}}))))}},data:function(){return{}}},q=j,$=(r("1ecc"),Object(c["a"])(q,a,n,!1,null,null,null));t["a"]=$.exports},cfc4:function(e,t,r){"use strict";r("8224")},e74a:function(e,t,r){"use strict";var a=r("2c67");t["a"]={getSchedules:function(e,t){return a["a"].post.apply(a["a"],["/schedule/getSchedules"].concat(Array.prototype.slice.call(arguments)))},saveSchedule:function(e,t){return a["a"].post.apply(a["a"],["/schedule/saveSchedule"].concat(Array.prototype.slice.call(arguments)))},inactivate:function(e,t){return a["a"].post.apply(a["a"],["/schedule/inactivate"].concat(Array.prototype.slice.call(arguments)))},activate:function(e,t){return a["a"].post.apply(a["a"],["/schedule/activate"].concat(Array.prototype.slice.call(arguments)))},deleteSchedule:function(e,t){return a["a"].post.apply(a["a"],["/schedule/deleteSchedule"].concat(Array.prototype.slice.call(arguments)))},getSchedule:function(e,t){return a["a"].post.apply(a["a"],["/schedule/getSchedule"].concat(Array.prototype.slice.call(arguments)))},commands:function(e,t){return a["a"].post.apply(a["a"],["/schedule/commands"].concat(Array.prototype.slice.call(arguments)))}}}}]);
//# sourceMappingURL=chunk-498f367c.3fbe87dd.js.map