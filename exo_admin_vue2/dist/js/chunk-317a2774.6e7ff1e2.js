(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-317a2774"],{"1f49":function(t,e,n){"use strict";n("93e9")},"590c":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t._self._c;return e("app-screen",[e("waiter",{ref:"tableWaiter"},[e("action-table",{ref:"table",staticClass:"sites-table",attrs:{name:"Sites",columns:t.columns,options:t.options},scopedSlots:t._u([{key:"beforeFilterWrapper",fn:function(){return[e("action-group",{},[e("action-button",{attrs:{title:t.exportMode?"Cancel Export":"Export Sites",icon:t.exportMode?t.$icons.close:t.$icons.export,variant:t.exportMode?"secondary":"primary"},on:{action:t.toggleExportMode}},[t._v("\n                        "+t._s(t.exportMode?"Cancel":"+ Export sites")+"\n                    ")])],1)]},proxy:!0},t.exportMode?{key:"actions",fn:function(n){var o=n.rows;return[e("action-group",[e("action-button",{directives:[{name:"show",rawName:"v-show",value:o&&o.length>0,expression:"rows && rows.length > 0"}],attrs:{title:"Export selected sites",icon:t.$icons.export,variant:"success"},on:{action:function(e){return t.exportSelected(o)}}},[t._v("\n                        Export selection ("+t._s(o.length)+")\n                    ")]),e("action-group-separator"),e("action-button",{attrs:{title:"Cancel export mode",icon:t.$icons.close,variant:"secondary"},on:{action:t.toggleExportMode}},[t._v("\n                        Cancel\n                    ")])],1)]}}:{key:"actions",fn:function(n){n.rows;return[e("action-group",[e("action-button",{attrs:{title:"Create new site",icon:t.$icons.add},on:{action:t.createSite}},[t._v("\n                        + Create site\n                    ")])],1)]}},{key:"main_domain_name",fn:function(n){var o=n.row;return[o.main_domain_name?e("a",{attrs:{href:"https://".concat(o.main_domain_name),target:"_blank"}},[t._v("\n                    "+t._s(o.main_domain_name)+"\n                ")]):e("span",{staticClass:"text-muted"},[t._v("No domain")])]}},{key:"col-action",fn:function(n){var o=n.row;return[t.exportMode?t._e():e("action-group",{on:{click:function(t){t.stopPropagation()}}},[e("action-button",{attrs:{title:"Edit site",icon:t.$icons.edit},on:{action:function(e){return t.editSite(o)}}}),e("action-button",{attrs:{title:"Open admin panel",icon:t.$icons.external},on:{action:function(e){return t.openAdminPanel(o)}}})],1)]}}],null,!0),model:{value:t.sites,callback:function(e){t.sites=e},expression:"sites"}})],1)],1)},r=[],i=(n("96cf"),n("3b8d")),a=(n("8e6e"),n("ac6a"),n("cadf"),n("456d"),n("4917"),n("bd86")),s=n("2c67");function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){Object(a["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var u={all:function(t,e){return s["a"].post.apply(s["a"],["/sites/all"].concat(Array.prototype.slice.call(arguments)))},export:function(t,e){return s["a"].post("/sites/export",t,l({responseType:"blob"},e)).then((function(t){var e=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=e;var o=t.headers["content-disposition"],r="sites_export.sql";if(o){var i=o.match(/filename="(.+)"/);i&&(r=i[1])}return n.setAttribute("download",r),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(e),t}))}},p={name:"SitesTable",components:{},props:{},data:function(){return{sites:[],exportMode:!1,columns:["site_id","site_alias","site_name","main_domain_name","col-action"],options:{filterable:!0,sortable:["site_id","site_alias","site_name","main_domain_name"],uniqueKey:"site_id",headings:{site_id:"ID",site_alias:"Alias",site_name:"Name",main_domain_name:"Host"},requestFunction:this.requestFunction}}},computed:{exportColumns:function(){return["col-check","site_id","site_alias","site_name","main_domain_name"]}},watch:{exportMode:function(t){this.columns=t?this.exportColumns:["site_id","site_alias","site_name","main_domain_name","col-action"]}},methods:{requestFunction:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=1,u.all(e);case 1:return t.abrupt("return",t.sent);case 2:return t.prev=2,n=t["catch"](0),console.error("Error loading sites:",n),t.abrupt("return",{data:[],total:0});case 3:case"end":return t.stop()}}),t,null,[[0,2]])})));function e(e){return t.apply(this,arguments)}return e}(),toggleExportMode:function(){this.exportMode=!this.exportMode,this.$refs.table&&this.$refs.table.clearSelection&&this.$refs.table.clearSelection()},exportSelected:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e&&0!==e.length){t.next=1;break}return this.$awn.warning("Please select at least one site to export"),t.abrupt("return");case 1:return t.prev=1,n=e.map((function(t){return t.site_id})),this.$awn.info("Exporting ".concat(e.length," site(s)...")),t.next=2,u.export({site_ids:n});case 2:t.sent,this.$awn.success("Successfully exported ".concat(e.length," site(s)")),this.toggleExportMode(),t.next=4;break;case 3:t.prev=3,o=t["catch"](1),console.error("Export error:",o),this.$awn.alert("Failed to export sites. Please try again.");case 4:case"end":return t.stop()}}),t,this,[[1,3]])})));function e(e){return t.apply(this,arguments)}return e}(),createSite:function(){this.$awn.info("Create site functionality not implemented yet")},editSite:function(t){this.$awn.info("Edit site ".concat(t.site_name," functionality not implemented yet"))},openAdminPanel:function(t){var e="/api/site-exo-admin/".concat(t.site_id);window.open(e,"_blank")},load:function(){this.$refs.table.refresh()}},mounted:function(){this.load()}},d=p,f=(n("1f49"),n("2877")),m=Object(f["a"])(d,o,r,!1,null,null,null);e["default"]=m.exports},"93e9":function(t,e,n){}}]);
//# sourceMappingURL=chunk-317a2774.6e7ff1e2.js.map